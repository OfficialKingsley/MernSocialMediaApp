import Head from "next/head";
import React, { useEffect } from "react";
import { useSelector } from "react-redux";
import { setPosts } from "../../state/postSlice";
import fetchPosts from "../../utils/fetchPosts";
import AddForm from "../components/AddForm";
import Container from "../components/Container";
import Layout from "../Layout";

const Home = () => {
  const userState = useSelector((state) => {
    return state.userState;
  });
  const user = userState.user;
  const token = userState.token;

  const postState = useSelector((state) => {
    return state.postState;
  });

  console.log("post state", postState);

  useEffect(() => {
    const getPosts = async () => {
      console.log(token);
      const data = await fetchPosts(token);
      console.log(data);
      if (data?.user) {
        setPosts(data);
      }
    };
    getPosts();
  }, []);

  return (
    <Layout>
      <Head>
        <title>SocioMedia | Home</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <div className="">
        <aside></aside>
        <main>
          <section className="py-4">
            <Container>
              <AddForm />
            </Container>
          </section>
          <section>
            <Container>
              {postState?.map((post) => (
                <div key={1}>divclass</div>
              ))}
            </Container>
          </section>
        </main>
      </div>
    </Layout>
  );
};

export default Home;
